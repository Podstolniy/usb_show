# -*- coding: utf-8 -*-
#my_unicode_string = u"This's Unicode!"
#!/usr/bin/python

import os
import platform
import csv
import subprocess
import sys
import argparse
import json
import math
import abc
from collections import Counter

def pars_str():	#	функция разбора строк из pars_repl()
	str = pars_repl()
	if len(str)!=0:
		str.pop(0)
	l=[]	#разбираем строку по разделителю
	a=0
	while a<len(str):
		l.append(str[a].replace('\\',' ').replace('&',' ').replace('VID_','').replace('PID_','').split(' '))
		a=a+1
	rec=[]	#делаем удобочитаемую маску вывода 'VID=','PID=','S/N='
	a=0
	for p in l:
		rec.append([p[0],'VID='+p[1],'PID='+p[2],'S/N='+p[3]])
		a=a+1
	return rec

def pars_repl(): #	функция парсинг даннх из wmic
	proc = subprocess.Popen('wmic path win32_usbhub Where (Caption="Запоминающее устройство для USB") get DeviceID', stdout=subprocess.PIPE, shell=False)
	(out, err) = proc.communicate()
	split_out=out.decode('utf-8').split()
	return split_out	

def main():
	str=pars_str()
	[print(p) for p in str]	
	
if __name__ == '__main__':
	main()
